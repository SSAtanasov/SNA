# Проектиране на компютърни мрежи — Йерархичен модел и редундантност

---

## Учебни цели

След този модул студентите ще:
- Разберат 4-те характеристики на надеждните мрежи
- Научат тристепенния йерархичен модел (Access Layer, Distribution Layer, Core Layer)
- Разграничат между MAC и IP адресирането  
- Проектират проста йерархична топология

---

## Надеждни мрежи — 4 основни характеристики

Мрежовите архитекти трябва да вземат под внимание четири основни характеристики, за да отговорят на очакванията на потребителите в съвременния свят, където мрежите не служат само за данни, а свързват хора, устройства и информация в среда, богата на мултимедия.

### 1. Отказоустойчивост (Fault Tolerance)

**Дефиниция:** Мрежа, която продължава да работи без прекъсване, когато един или повече компоненти откажат.

**Механизъм:** Редундантност (наличие на алтернативни пътища)

**Как работи:**
- При отказ на един маршрут (рутер, кабел или връзка), пакетите се автоматично препращат по друга връзка
- Рутерите динамично преизчисляват маршрутите
- Потребителят не усеща прекъсване

**Процес на работа (слайдове 4-7):**
1. **Проблемна ситуация (слайд 4-6):** Имаме PC1 свързан към Рутер A и PC2 свързан към Рутер B. Всеки рутер има своя път към интернет доставчика (ISP). Ако Рутер A откаже, PC1 остава без връзка.

2. **Решение със редундантност (слайд 7):** Добавяме допълнителни връзки между устройствата:
   - Връзка между Рутер A и Рутер B
   - Алтернативни пътища от комутаторите към рутерите
   - Множество пътища към дестинацията

3. **Автоматично пренасочване (слайд 8):** При отказ на един път пакетите се автоматично препращат по друга връзка.

**Времеви период на адаптация (Convergence time):** Обикновено секунди до минути, зависи от мрежовите протоколи за маршрутизиране (OSPF, EIGRP).

**Баланс на цена срещу надежност:**
- Повече редундантност = по-висока надежност ✓
- Повече редундантност = по-висока цена ✗
- Решение: Определете компромис според критичност на услугата

### 2. Мащабируемост (Scalability)

**Дефиниция:** Мрежа, която може да растне бързо, поддържайки нови хардуерни ресурси, нови услуги и нови потребители, БЕЗ влошаване на производителност.

**Проблем на плоските мрежи (Flat Networks):**
- Всички устройства в един broadcast домейн
- Broadcast буря — всички broadcast съобщения достигат всички устройства
- Огромни МАС адресни таблици
- Невъзможност за растеж без пълна преработка
- Трудно управление
- Рисково за сигурност

**Решение:** Разделяне на мрежата на по-малки, управляеми сегменти

**Стратегии за мащабируемост:**
- Йерархичен дизайн (вижте по-долу)
- Виртуални локални мрежи (VLAN)
- Правилно планиране на IP адресното пространство
- Модулен подход — лесно добавяне на нови сегменти

### 3. Качество на услугата (QoS — Quality of Service)

**Дефиниция:** Способност на мрежата да управлява претоварване, приоритизира критичен трафик и осигурява надежда доставка на съдържание.

**Проблеми при липса на QoS:**
- Видеоконференции се прекъсват поради претоварване
- Важни данни се забавят
- Всички пакети имат еднакъв приоритет

**Решение — QoS политики:**
- Приоритизиране на трафика — критични услуги първо (VoIP, видео, бази данни)
- Управление на пропускателната способност — разпределение за различни приложения
- Открояване и намаляване на претоварването
- Гарантирана латентност (закъснение) за критични приложения

**Където се конфигурира:** На слоя Разпределение (L3 комутатори, рутери)

### 4. Сигурност (Security)

**Дефиниция:** Защита на инфраструктурата, информацията и услугите от неоторизиран достъп и повреди.

**CIA Триада (Основни принципи):**
- **Конфиденциалност (Confidentiality)** — само оторизирани лица могат да видят информацията
- **Целостност (Integrity)** — информацията не е модифицирана по пътя
- **Достъпност (Availability)** — услугите са достъпни когато са нужни

**Сегментация на мрежата:**
- **Access Layer** — устройства на потребители (по-нисък ниво на доверие)
- **Distribution Layer** — контролна точка, където се прилагат политики (ACLs, криптиране)
- **Core Layer** — критични системи

**Инструменти за сигурност:**
- Правила на Firewall (ACLs)
- Криптиране на данни (TLS, IPSec)
- Виртуални локални мрежи за разделяне на потребители (например Гостна VLAN отделена от Корпоративна VLAN)
- Системи за открояване на проникване (IDS)

---

## Йерархичен мрежов дизайн — 3-слойния модел

Йерархичната архитектура разделя мрежата на три четко определени слоя, всеки със своя роля и отговорност.

```
┌────────────────────────────────────────────────┐
│        CORE LAYER (Гръбнак на мрежата)         │
│  • Високоскоростен backbone (40/100 Гигабита) │
│  • Минимално процесиране (СКОРОСТ!)            │
│  • Резервни връзки между Distribution Layer    │
│  • Устройства: Catalyst 9600, ASR 1000         │
│  • Цел: Бързо транспортиране на данни          │
└────────────────────────────────────────────────┘
           ↕          ↕          ↕
┌────────────────────────────────────────────────┐
│    DISTRIBUTION LAYER (Разпределение)          │
│  • Свързва мрежи на Access Layer               │
│  • Маршрутизиране МЕЖДУ различни мрежи         │
│  • Прилагане на политики (ACLs, QoS)           │
│  • Устройства: C9300 L3 комутатори, Рутери    │
│  • Контрол на потока трафик                    │
└────────────────────────────────────────────────┘
     ↕        ↕        ↕        ↕
┌────────────────────────────────────────────────┐
│  ACCESS LAYER (Достъп на потребители)          │
│  • Точка на свързване за крайни устройства    │
│  • L2 комутиране (MAC адресиране)             │
│  • Устройства: Комутатори 2960-XR, WAP        │
│  • Всички устройства в един слой имат          │
│    една локална мрежа                          │
│  • Broadcast съобщенията остават локални      │
└────────────────────────────────────────────────┘
  ↕   ↕    ↕    ↕    ↕    ↕
[ПК][ПК][Телефон][Принтер][WAP][Сървър]
```

### Access Layer

- **Функция:** Точка на свързване за крайни устройства
- **Технология:** L2 комутиране (MAC адресиране)
- **Устройства:** Access комутатори (Catalyst 2960-XR), Безжични точки за достъп (WAP)
- **Проектиране:** Всички устройства, свързани към един Access комутатор, принадлежат на **една локална мрежа** (една IP подмрежа)
- **Broadcast домейн:** Broadcast съобщенията остават локални, не се разпространяват нагоре
- **Пример:** Всички компютри и принтери на един етаж свързани към един комутатор

### Distribution Layer

- **Функция:** Взаимосвързване на мрежи на Access Layer; маршрутизиране МЕЖДУ различни сегменти на мрежа
- **Технология:** L3 маршрутизиране (IP адресиране)
- **Устройства:** L3 комутатори (Catalyst 9300 серия), Модули на рутери
- **Политики:** Това е мястото, където се прилагат ACLs, QoS политики, политики за сигурност
- **Проектиране:** Контролна точка между различни мрежи на Access Layer
- **Пример:** Маршрутизира трафик между различни етажи или офис отделения

### Core Layer

- **Функция:** Високоскоростен backbone за препращане на трафик между точките на Distribution Layer
- **Технология:** Крайно висока скорост на препращане (минимално процесиране)
- **Пропускателна способност:** 40 Гигабита, 100 Гигабита или дори още повече
- **Устройства:** Висок клас рутери (ASR 1000), Основни комутатори
- **Проектиране:** Минимално филтриране — просто СКОРОСТ
- **Примери:** Трафик между офисите, връзка към интернет

---

## Преимущества на йерархичния дизайн

- ✓ **Мащабируемост** — лесно добавяне на нови сегменти
- ✓ **Редундантност** — може да се добави на всяко ниво
- ✓ **Производителност** — трафикът остава локален където е възможно
- ✓ **Сигурност** — политиките на слоя Разпределение
- ✓ **Управляемост** — ясна структура и отговорности
- ✓ **Предвидимост** — известно поведение и мрежови потоци

---

## MAC срещу IP адресиране

### MAC (Media Access Control) адресиране — Физически адрес

**Функция:** Адресира устройства в **локална мрежа** (LAN).

- **Формат:** 48 бита (6 байта), например `00:1A:2B:3C:4D:5E`
- **Уникален за:** Физическото устройство (NIC — мрежова карта)
- **Промяна:** НИКОГА се не променя (вграден в паметта)
- **Използване:** За локална доставка в същата мрежа (L2)
- **Обхват:** Само в локалната мрежа между комутатори

**Функция:** ARP протокол преобразува IP адреси в MAC адреси; Ethernet рамки съдържат целеви и изходящи MAC адреси; Комутаторите използват MAC адреси за търсене на таблица.

### IP (Internet Protocol) адресиране — Логически адрес

**Функция:** Адресира устройства **йерархично във връзката**.

- **Формат:** 32 бита (IPv4), например `192.168.1.10`
- **Структура:** Мрежова част + Част на хоста
- **Промяна:** МОЖЕ да се променя при преместване или преконфигуриране
- **Използване:** За отдалечена доставка между мрежи (L3)
- **Обхват:** Цял интернет, глобален

**Функция:** Маршрутизиране — рутерите гледат IP заглавката, не MAC; Разделяне на устройства на мрежи (подмрежериране); Йерархична структура позволява ефективно маршрутизиране.

### Комуникационен процес

**Локална комуникация (в същия Access Layer):**
```
Изходящ ПК → Access комутатор (MAC търсене) → Целев ПК
```
- Само MAC адреси се променят
- IP адреси остават същите
- Трафикът остава в локалния комутатор

**Отдалечена комуникация (различни мрежи):**
```
Изходящ ПК → Access комутатор → Distribution Layer (IP маршрутизиране) 
→ друг Distribution Layer → друг Access комутатор → Целев ПК
```
- IP адресата остава същата през целия път
- MAC адресата се променя на всяка hop (преход) между устройства
- Distribution Layer решава куда да го изпрати

---

## Практически казус: Растяща компания без йерархичен дизайн

### История

Един малък магазин има растваща се мрежа.
- **Начало:** няколко компютра свързани към един комутатор
- **Сега:** 20+ устройства, но мрежата е **плоска** (не йерархична)

### Препоръка на специалист

"Инвестирайте в правилен дизайн СЕГА, преди да е късно!"

### Проблеми на "органичния растеж"

- ✗ Няма планиране на IP адресното пространство
- ✗ Всички устройства в един broadcast домейн
- ✗ Критични сървъри смесени с гостни устройства
- ✗ Няма редундантност — един комутатор откаже = всичко спира
- ✗ Няма QoS — видеоконференциите се прекъсват
- ✗ Сигурност е "последна мисъл"
- ✗ Трудно добавяне на нови офиси/етажи

### Решение: Йерархичен дизайн

- ✓ Access Layer за устройства на потребители
- ✓ Distribution Layer за маршрутизиране между офиси
- ✓ Core Layer за интернет свързаност
- ✓ Правилно IP планиране (VLAN за всяко отделение)
- ✓ Резервни връзки
- ✓ QoS политики
- ✓ Сигурност на Distribution Layer

### Пример с IP планиране

```
Access Layer:
- Етаж 1: 192.168.10.0/24 (Счетоводство)
- Етаж 2: 192.168.20.0/24 (Продажби)
- Етаж 3: 192.168.30.0/24 (ИТ)

Distribution Layer:
- Маршрутизира между етажите
- Прилага QoS за видеоконференции
- Firewall правила между отделения

Core Layer:
- Връзка към интернет
- Резервни връзки към Distribution Layer

Резултати:
- Broadcast домейнътите са изолирани
- Могат да добавят нови етажи без проблем
- QoS работи за критични услуги
- Редундантност осигурява актуално време
- Политики за сигурност могат да се прилагат централизирано
```

---

## Въпроси за размисъл

1. **Вашата домашна/училищна мрежа:**
   - Колко устройства имате?
   - Има ли планиране или е органичен растеж?
   - Какво би се случило при отказ на рутера?
   - Има ли QoS за игрови потоци или видео разговори?

2. **Малък бизнес сценарий:**
   - Как бихте проектирали мрежа за 50 служители?
   - Колко Access комутатора?
   - Нужен ли е Distribution Layer?
   - Как да планирате IP адреси?

3. **Рискове на плоската мрежа:**
   - Какво се случва при broadcast буря?
   - Последствия за сигурност?
   - Проблеми с мащабируемост?

4. **Обратна инвестиция (ROI):**
   - Колко струва 1 час престой за бизнеса?
   - Колко струва правилният дизайн?
   - Което е по-скъпо дългосрочно?

---

## Практически съвети

### За домашна мрежа:
- ✓ Използвайте качествен рутер с QoS
- ✓ Разделете гостна и семейна Wi-Fi
- ✓ Обмислете управляван комутатор за VLAN
- ✓ Резервна интернет връзка (мобилен хотспот)

### За малък бизнес:
- ✓ Започнете с йерархичен дизайн от ден 1
- ✓ Планирайте IP пространство за 3-5 години напред
- ✓ VLAN за всяко отделение
- ✓ Резервни връзки нагоре
- ✓ Документирана топология и IP план

---

## Ключови принципи за запомняне

1. **Надеждни мрежи = 4 характеристики** — Отказоустойчивост, Мащабируемост, QoS, Сигурност

2. **Йерархичният дизайн решава мащабируемост** — Access Layer, Distribution Layer и Core Layer

3. **Редундантност предотвратява престой** — алтернативни пътища, автоматично маршрутизиране

4. **MAC адреси работят локално** — IP адреси работят глобално

5. **Планиране е критично важно** — проектирайте ПРАВИЛНО от началото, не реактивно

6. **Пакетното комутиране осигурява гъвкавост** — пакетите могат да вземат различни пътища

7. **Distribution Layer е контролна точка** — QoS, сигурност, прилагане на политики

---

**гл. ас. Светослав Атанасов**  
svetoslav.atanasov@trakia-uni.bg


<script data-goatcounter="https://satanasov.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

<script src="/SNA/assets/js/analytics-logger.js"></script>
