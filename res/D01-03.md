# Клиенти и сървъри — Приложни услуги (L7)
**Курс:** Системно и мрежово администриране | **Модул:** D01-03

---

## Клиенти и сървъри — Дефиниции

**Клиент** — устройство или програма, която използва услуга. В програмирането клиентът е програма, която изпраща заявки (request) за данни по мрежа. Примери: браузър (Chrome, Firefox), имейл клиент (Outlook), FTP клиент.

**Сървър** — доставчик на услуги. Програма, която докато работи, предоставя отговори (response) на заявки. Може да се отнася и за физическия компютър със специализиран хардуер. Всяка услуга изисква отделна сървърна програма.

---

## Типове сървъри (основни)

**Web Server** — хоства уебсайтове, обработва HTTP/HTTPS заявки (Apache, Nginx, IIS).

**Database Server** — управлява централизирана база данни (MySQL, PostgreSQL, Oracle), позволява едновременен достъп от множество клиенти.

**File Server** — централизирано съхранение на потребителски данни, оборудван с бързи и големи твърди дискове.

**Mail Server** — съхранява пощенски кутии, управлява изпращане и получаване на имейли.

**DHCP Server** — автоматично разпределя IP адреси, маски на подмрежи и конфигурационни параметри.

**DNS Server** — преобразува домейни (www.example.com) в IP адреси (192.168.1.1).

**Proxy Server** — управлява централен интернет достъп, маршрутизира заявки между локална мрежа и интернет.

**FTP Server** — позволява изтегляне и качване на файлове.

**SSH Server** — предоставя защитен отдалечен достъп до командния ред.

---

## Архитектури на информационни системи

### Класическа архитектура (1-слой)
Всичко на един компютър — GUI интерфейс, бизнес логика, данни. Пример: локална програма, която съхранява данни в един файл.

### Клиент-Сървър модел (2-слой)
Един физически сървър със сървърна програма, множество физически клиентски компютри със клиентски програми. Пример: файлов сървър в офис.

### 3-Tier (3-нива) архитектура — Модерна, разпределена, мащабируема

**Презентационно ниво (Client Layer)** — браузър или мобилно приложение. Потребителят взаимодейства чрез GUI.

**Приложно ниво (Application Layer/Business Logic)** — сървърни програми със бизнес логика, генериране на динамични уеб страници. Примери: Apache, Nginx, Node.js, Django, ASP.NET.

**Ниво с данни (Data Layer/Database)** — база данни, която съхранява информацията. Примери: MySQL, PostgreSQL, MongoDB.

Всички три нива се разпределят на отделни физически компютри или дори множество компютри.

### Слоеве (Layers) vs. Нива (Tiers) — Важна разлика

**OSI/TCP/IP слоеве** — описват как се структурира **комуникацията** между две страни (L1-L7, как се предават данни по мрежата).

**Нива на архитектура (Tiers)** — описват как се структурира **информационната система** (презентация, логика, данни).

Това са две различни концепции, макар че на български обе се превеждат като "слой".

---

## Peer-to-Peer (P2P) мрежи

Всеки компютър изпълнява и клиентска, и сървърна роля едновременно.

**Примери P2P приложения:** BitTorrent, Skype (ранни версии), Bitcoin/Ethereum блокчейн, Kazaa.

**Преимущества:** лесно настройване, нисък разход, подходящо за споделяне на файлове и принтери.

**Недостатъци:** няма централизирано управление, нискa сигурност, не е мащабируемо, устройствата могат да станат бавни.

**Хибридна P2P:** ресурсите се разпределят между пиърите, но индексите на ресурсите се съхраняват централизирано.

---

## Client-Server връзка — URI, URL, URN

**URI (Uniform Resource Identifier)** — низ от символи, който идентифицира специфичен мрежов ресурс.

**URL (Uniform Resource Locator)** — определя **мрежовото място** на специфичен ресурс. Примеси: HTTP, HTTPS, FTP, SFTP.

**URN (Uniform Resource Name)** — идентифицира само **пространството на имената** без протокол.

**Части на URL:** 
- Протокол/схема (HTTPS, HTTP, FTP)
- Хостнейм (www.example.com)
- Пътека и име на файл (/author/book.html)
- Фрагмент (#page155)

---

## Основни услуги за мрежови приложения

**HTTP/HTTPS** (L7) — уеб браузъри заявяват и получават уеб страници (портове 80 за HTTP, 443 за HTTPS).

**FTP** (L7) — файлов трансфер, портове 21 (контрол) и 20 (данни).

**SSH** (L7) — защитен отдалечен достъп, порт 22. **Предпочитан вместо Telnet**.

**Telnet** (L7) — виртуален терминал, порт 23. **Несигурен** — всички данни се предават в plaintext.

**SMTP** (L7) — изпращане на имейли, порт 25.

**POP3** (L7) — получаване на имейли, порт 110.

**IMAP** (L7) — получаване на имейли, портен синхронизация с сървър, порт 143.

**DHCP** (L7) — автоматична IP конфигурация.

**DNS** (L7) — преобразуване на домейни в IP адреси, порт 53.

---

## DNS (Domain Name System) — Подробно обяснение

DNS е йерархична система, която преобразува домейни (www.cisco.com) в IP адреси (192.168.1.1). Без DNS клиентите не биха могли да се свържат с сървъри, защото хората помнят имена, не IP адреси.

### DNS йерархия (4 нива)

```
┌─────────────────────────────────────────────────────┐
│ Root Name Servers (13 сървъра, 750+ инстанции)    │
└──────────────┬──────────────────────────────────────┘
               │ "Гледай .com TLD сървър"
               ↓
┌──────────────────────────────────────────────────────┐
│ TLD Servers (.com, .org, .bg и т.н.)               │
└────────────┬─────────────────────────────────────────┘
             │ "Гледай cisco.com сървър"
             ↓
┌──────────────────────────────────────────────────────┐
│ Authoritative Servers (cisco.com сървър)            │
│ (Официалният притежател на cisco.com домейна)       │
└────────────┬─────────────────────────────────────────┘
             │ "www.cisco.com = 192.0.2.1"
             ↓
┌──────────────────────────────────────────────────────┐
│ Local DNS Server (Recursive DNS на ISP)             │
│ Кешира резултатите за бързо намиране следващия път │
└──────────────────────────────────────────────────────┘
```

### Пълен процес на DNS разрешаване

**Сценарий:** Клиент въвежда www.cisco.com

**Стъпка 1 — Локален кеш на клиента**
- ОС проверява своя DNS кеш
- Ако адресът е там → връщане на отговор (моментално)
- Ако нема → Стъпка 2

**Стъпка 2 — Локален DNS сървър (рекурсивен DNS)**
- Клиент изпраща заявка към IP на локалния DNS (обикновено от ISP)
- Локалният DNS проверява своя кеш
- Ако има → отговор обратно към клиент
- Ако нема → Стъпка 3

**Стъпка 3 — Root Name Server**
- Локалният DNS пита root сървър
- Root НЕ знае точния IP, но знае към кого да препрати
- Обикновено локалният DNS вече има .com TLD IP в кеша, така че прескача този step

**Стъпка 4 — TLD Server (.com)**
- Локалният DNS пита .com TLD сървър
- Вълна: "Къде е cisco.com?"
- .com TLD сървърът знае IP адреса на cisco.com authoritative сървъра
- Изпраща на локалния DNS

**Стъпка 5 — Authoritative Server (cisco.com)**
- Локалният DNS пита cisco.com authoritative сървъра
- Вълна: "Какъв е IP на www.cisco.com?"
- Authoritative сървърът съдържа ВСИЧКИ IP адреси за cisco.com домейни
- Отговаря с точния IP адрес на www.cisco.com

**Стъпка 6 — Кеширане и отговор**
- Локалният DNS кешира новия IP адрес
- Изпраща адреса на клиента
- Клиентът кешира адреса в своя DNS кеш
- Сега клиентът има IP и може да изпрати пакети към www.cisco.com

### Защо е важен DNS кешът?

**Първи път:** всички стъпки 1-6 могат да отнемат 100-500 ms
**Втори път:** директно от кеша на клиента или локалния DNS ~ 1-10 ms

Резултат: **хиляди пъти по-бързо второ посещение!**

### DNS рекордни типове (основни)

**A запис** — IPv4 адрес (www.example.com → 192.0.2.1)

**AAAA запис** — IPv6 адрес

**MX запис** — мейл сървър (за получаване на имейли)

**CNAME запис** — алиас (www.example.com е алиас на example.com)

**NS запис** — указва authoritative DNS сървър за домейн

### nslookup команда — Тестване на DNS

```bash
nslookup www.cisco.com
```

Показва:
- IP адреса на DNS сървъра, който е използван
- Отговарящия IP адрес на www.cisco.com
- TTL (Time To Live) — кога记録ът експира

Използва се за диагностика и проверка на DNS конфигурация.

---

## HTTP и HTTPS — Уеб услуги

**HTTP** — Hypertext Transfer Protocol, порт 80. **Несигурен** — данните се предават в plaintext.

**HTTPS** — HTTP Secure (с SSL/TLS криптография), порт 443. **Препоръчан** за всички задачи, требащи сигурност.

**HTML** — Hypertext Markup Language, език за форматиране на уеб страници.

При заявка на уеб страница браузърът (клиент) изпраща HTTP GET заявка към сървъра, сървърът отговаря с HTML съдържание.

---

## Email протоколи

**SMTP (Simple Mail Transfer Protocol)** — изпращане на имейли между клиент-сървър и сървър-сървър, порт 25.

**POP3 (Post Office Protocol)** — получаване на имейли, портен 110. Изтегля имейлите **на локалния компютър**, премахва ги от сървъра.

**IMAP4 (Internet Message Access Protocol)** — получаване на имейли, порт 143. **Синхронизира** имейлите — те остават на сървъра, видими от всички устройства.

Формат на пощенска кутия: user@company.domain

---

## Безопасност — Telnet vs SSH

**Telnet** — виртуален терминал, позволява отдалечен CLI достъп.
- **Несигурен** — всички данни (пароли, команди) се предават като plaintext
- **Лесно хакуване** — перехватаният трафик е директно четим
- Порт 23

**SSH (Secure Shell)** — защитена алтернатива.
- **Криптирани** всички данни
- **По-силна удостоверяване** — использование ключеве, не само пароли
- **Препоръчан** за всички администрирани устройства
- Порт 22

**Най-добра практика:** Винаги използвай SSH вместо Telnet.

---

## Ключни принципи

DNS е **критично важен** за интернета — без него клиентите не биха могли да намирали сървъри по име.

**3-Tier архитектура** позволява **мащабируемост** — всяко ниво може да работи на отделни компютри или дори облачни сървъри.

Разбирането на **Client-Server модела** е основа за администрирането на мрежи.

DNS кешът е причината, поради която второ посещение е толкова бързо — коли съхранява информацията локално.

Знанието на DNS процеса е критично за troubleshooting при интернет свързаност проблеми.
