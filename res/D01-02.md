# Принципи на комуникацията (L1-L2 мост)
**Курс:** Системно и мрежово администриране | **Модул:** D01-02

---

## Комуникационни протоколи

### Защо протоколите са важни

Протоколите са набор от договорени правила, които управляват мрежовата комуникация. Както хората установяват правила преди разговор (език, метод, потвърждение), компютрите използват протоколи.

**Характеристики на протоколите:**

**Формат на съобщението** — специфична структура на данните, зависи от канала и тип съобщение.

**Размер на съобщението** — регулирана дължина на пакетите. Дълги съобщения се разделят на по-малки части за надеждна доставка.

**Време за доставяне** — синхронизация между устройствата, скорост на предаване, определяне на кога может устройство да изпрати данни.

**Кодиране** — преобразуване на битовете в разпознаваеми модели (електрически импулси, светлина, радиовълни).

**Капсулиране** — добавяне на адресна информация (header) с идентификация на източник и дестинация, осигуряване доставяне до правилното приложение.

**Шаблон** — някои съобщения изискват потвърждение преди следващото съобщение (request/response модел), други се предават без контрол.

---

## Интернет и стандартите

**Стандартите** определят как нещо трябва да се извършва. Интернет стандартите гарантират, че всички устройства прилагат един набор правила един и същи начин.

Например, форматирането, препращането и получаването на имейли се определя от стандарт — човек с персонален компютър може да изпрати имейл, който да се прочете на мобилен телефон, ако и двете устройства използват същите стандарти.

### Организации за мрежови стандарти

**IETF (Internet Engineering Task Force)** — разработва и публикува интернет стандарти чрез RFC (Request for Comments) документи.

**ISO/IEC (International Organization for Standardization)** — разработва международни стандарти.

**IEEE (Institute of Electrical and Electronics Engineers)** — развива стандарти за свързаност (Ethernet, Wi-Fi).

**ICANN (Internet Corporation for Assigned Names and Numbers)** — управлява IP адреси, домейни и DNS.

**W3C (World Wide Web Consortium)** — разработва стандарти за уеб (HTML, CSS, JavaScript).

---

## Мрежови комуникационни модели

### Протоколен стек

Успешната комуникация изисква използването на няколко протокола от различни слоеве, образуващи **протоколния стек**.

При отваряне на уеб страница (например www.example.com):
- **Ethernet** (L1-L2) — физическа връзка между мрежови карти в същата мрежа
- **IP** (L3) — адресиране и доставка до крайна дестинация
- **TCP** (L4) — надеждна доставка, перепращане при загуба
- **HTTP** (L7) — управление на HTML съдържание

### TCP/IP модел (4 слоя) — Реалната имплементация

**Layer 4: Application** — протоколи за приложения (HTTP, DNS, DHCP, FTP, HTTPS, SSH, SMTP).

**Layer 3: Transport** — надеждна или бърза доставка (TCP за надеждност, UDP за скорост).

**Layer 2: Internet** — адресиране и рутиране между мрежи (IPv4, IPv6, ICMP).

**Layer 1: Network Access** — физическа връзка (Ethernet, Wi-Fi, PPP).

### OSI референтен модел (7 слоя) — Теоретичен, детайлен

**Layer 7: Application** — услуги за приложения.

**Layer 6: Presentation** — форматиране, кодиране на данни.

**Layer 5: Session** — управление на сесии.

**Layer 4: Transport** — сегментиране и надежда доставка.

**Layer 3: Network** — адресиране, рутиране.

**Layer 2: Data Link** — обмен на рамки (frames).

**Layer 1: Physical** — физическа среда, битови предавания.

### OSI vs TCP/IP — Хибриден подход в практиката

Индустрията **използва номерирането на OSI** (L1, L2, L3, L4, L7), но **реалните протоколи са от TCP/IP**:

- **L2 switch** — работи с Ethernet (L1-L2 в OSI)
- **L3 routing** — работи с IP (L3 в OSI)
- **L4 TCP/UDP** — транспортни протоколи
- **L7 Applications** — HTTP, DNS, HTTPS

L5 и L6 (Session, Presentation) се **почти не използват в практиката**.

---

## Капсулация на данни

Капсулацията е процесът на добавяне на headers (и trailers) към данните докато те преминават през всяка мрежова слой.

### Процес на капсулация (горе-надолу)

```
Layer 7 (Application): User enters URL → HTTPS Encapsulation
                       DATA

Layer 4 (Transport): TCP добавя header → TCP SEGMENT
                    [TCP Header] [DATA]

Layer 3 (Network): IP добавя header → IP PACKET
                  [IP Header] [TCP Header] [DATA]

Layer 2 (Data Link): Ethernet добавя header + trailer → FRAME
                    [Eth Header] [IP Header] [TCP Header] [DATA] [FCS]

Layer 1 (Physical): Преобразуване в битове
                   01010101010101010101...
```

**Терминология (PDU — Protocol Data Unit):**
- **Data** — L7 приложни данни
- **Segment** — L4 с TCP/UDP header
- **Packet** — L3 с IP header
- **Frame** — L2 с Ethernet header/trailer
- **Bits** — L1 физическа представа

### Ключови моменти при капсулация

IP адресирането остава **същото** от източник до дестинация (освен при NAT).

Рутерите (L3 устройства) разглеждат само **IP header** при маршрутизиране.

Data link слоят (L2) е **единственият**, който добавя trailer (FCS — Frame Check Sequence).

Всеки слой приема предишния header + data и го обвива със свой header, този header и data стават **data** за следващия слой.

---

## PDU (Protocol Data Unit)

**PDU** е единицата данни на всеки протокол — това е начина, по който протоколът организира информацията.

### Важност на PDU познаването

**Troubleshooting** — разбиране кой слой е причина за проблема (L1 кабел, L2 мост, L3 рутиране, L7 приложение).

**Wireshark анализ** — при анализа на пакети виждаш PDU-та на всяко ниво с техните headers.

**Правилна терминология** — казваш "пакет" (L3), не "пакет" за frame (L2) — разлика при диагностика.

### Практически сценарии

**Web browsing (HTTP):**
- HTTP DATA → TCP SEGMENT → IP PACKET → Ethernet FRAME → BITS

**Ping команда (ICMP):**
- ICMP DATA → IP PACKET → Ethernet FRAME → BITS

**File transfer (FTP):**
- FTP DATA → TCP SEGMENT → IP PACKET → Ethernet FRAME → BITS

### Запомняне на PDU имена — Акроним

**DSTNB** или **DSPFB:**
- **D**ata (Layer 7)
- **S**egment (Layer 4)
- **P**acket (Layer 3)
- **F**rame (Layer 2)
- **B**its (Layer 1)

---

## Ключови принципи на комуникацията

Протоколите управляват **всички аспекти** на мрежовата комуникация — от физическата среда до приложното съдържание.

Стандартизацията позволява **разнородни устройства** да се свързват и обменят данни безпроблемно.

Капсулацията е **многопластова** — всеки слой добавя своя информация, скривайки горните слоеве.

Разбирането на OSI и TCP/IP модели е **критично** за администрирането и troubleshooting на мрежи.

Познаването на PDU и капсулацията помага при **диагностика** с инструменти като Wireshark и командния ред.


<script data-goatcounter="https://satanasov.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

<script src="/SNA/assets/js/analytics-logger.js"></script>

